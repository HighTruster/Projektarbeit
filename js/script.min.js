function loadBerufe(){var e,a;$("#beruf").append($("<option/>",{value:"",text:"Please select your profession"})),$.getJSON("http://home.gibm.ch/interfaces/133/berufe.php",null,function(l){$.each(l,function(l,s){e=null,a=null,$.each(s,function(l,s){"beruf_id"==l?e=s:a=s}),$("#beruf").append($("<option/>",{value:e,text:a}))}),$("#beruf").show(),$("#beruf_loading").hide(),isNaN(cookies[0])||($("#beruf").val(cookies[0]),loadClass())})}function loadClass(){var e,a,l=!1,s=$("#beruf").val();(isNaN(cookies[0])||cookies[0]!=s)&&(document.cookie="klasse_id=",$("#klasse").empty(),$("#klasse").hide(),$("#klasse_loading").show(),l=!0),document.cookie="beruf_id="+s,s>=0&&""!=s?($("#klasse").append($("<option/>",{value:"",text:"Please select your class"})),$.getJSON("http://home.gibm.ch/interfaces/133/klassen.php","beruf_id="+s,function(s){$.each(s,function(l,s){e=null,a=null,$.each(s,function(l,s){"klasse_id"==l?e=s:(l="klasse_longname")&&(a=s)}),$("#klasse").append($("<option/>",{value:e,text:a}))}),$("#klasse_loading").hide(),$("#klasse").show(),isNaN(cookies[1])||l||($("#klasse").val(cookies[1]),classSelected(null))}),$("#klasse_div").show()):$("#klasse_div").hide()}function classSelected(e){document.cookie="klasse_id="+$("#klasse").val(),$("#deleteCookie").removeClass("hidden"),$("#kalender_head").html("Scheduler form  - "+$("#klasse>option:selected").html()),loadCalendar(e),$("#filter_body").hide()}function loadCalendar(e){var a,l,s,n,o,t,i,c,r;$("#klasse").val()>=0&&""!=$("#klasse").val()?($("#calendar_panel").show(),$("#calendar").fullCalendar({lang:"de",header:!1,events:function(e,u,d,k){$.ajax({url:"http://home.gibm.ch/interfaces/133/tafel.php",dataType:"jsonp",data:{klasse_id:$("#klasse").val(),woche:e.isoWeek()+"-"+e.year()},success:function(e){var u=[];$.each(e,function(e,d){a=null,l=null,s=null,n=null,o=null,t=null,i=null,c=null,r=null,$.each(d,function(e,d){$.each(d,function(e,r){switch(e){case"tafel_datum":a=r;break;case"tafel_wochentag":l=r;break;case"tafel_von":s=r;break;case"tafel_bis":n=r;break;case"tafel_lehrer":o=r;break;case"tafel_longfach":t=r;break;case"tafel_raum":i=r;break;case"tafel_kommentar":c=r}}),r=Math.abs(new Date("01/01/1970 "+s).getTime()/1e3/60-new Date("01/01/1970 "+n).getTime()/1e3/60),u.push({title:t+(r>45?"\r\n"+o+"\r\n"+i:""),start:a+"T"+s,end:a+"T"+n,description:t+"<br />"+o+"<br />"+i+(""!=c?"<br /><br /><em>"+c+"</em>":"")})})}),k(u)}})},weekNumbers:!0,allDaySlot:!0,weekends:!0,defaultView:"agendaWeek",contentHeight:"auto",minTime:"07:00:00",maxTime:"21:00:00",slotLabelFormat:"HH:mm",timeFormat:"HH:mm",eventRender:function(e,a){a.qtip({position:{my:"center center",at:"bottom center"},content:e.description})}}),$("#calendar").fullCalendar("refetchEvents")):$("#calendar_panel").hide()}function deleteCookie(){$.cookie("beruf_id","",{path:"/html"}),$.cookie("klasse_id","",{path:"/html"})}var savingCookies=document.cookie.split("; "),cookies=new Array(null,null);$.each(savingCookies,function(e,a){var l=a.split("=");switch(l[0]){case"beruf_id":cookies[0]=l[1];break;case"klasse_id":cookies[1]=l[1]}});